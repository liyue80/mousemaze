/*
 *
 */
#include <stdio.h>
#include <string.h>
#include "StandardSpace.h"
#include "ParallelSpace.h"
#include "FastDeque.h"
#include "FixedMemPool.h"

/* **************************************
* Main function and global variables.
************************************** */
#define WIDTH  30
#define HEIGHT 30

/* 已知的3个测试用例 */
#define C1 "111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111111111111111101111111111111111"
#define C2 "111110000000000000000000000011110010111111111110111111110100110010100000010000100000010010110011111100010000100111110010110010100101111110100000010010110110100101111110111111111110111010100101111110100000010010110010100101111110101111110010110010100101111110100000010010110110100101111110111111010110111010100101111110100000010010110010110111111111100000010010110010101001010100101111110110110010100101010101100000010010010010100001010110111111110110010010111101010100111111110010011110100000010101111111110110000000100000000110111111110010111011111111110100111111110010101011100000000100111111110010101011100000000101100000001110101011111111110110100000000010101011100000001100101111111110111000101001000100100000000000001000101001000000111111111111011111111111111110010000010001010100101010010010001010100111010100101010010011111111100100010100101110010100101010111111110111100011110000000000000001"
#define C3 "111110000100010010101001000011110010111111111110111111110100110010100000010000100000010011110011111100010000101111110010110010100101111110100000010010110110100101111110111111111111111010100101111110100000010010110010100101111110101111110010110010100101111110100000010010110110100101111110111111010111111010100101111110100000010010110010110111111111100000010010110010101001010100101111110111110010100101010101100000010010010010100001010110111111110111010010111101010100111111110010011110100000010101111111110111000000100000010110111111110010111011111111110100111111110010101011100000010100111111110010101011100000010101100000001111101011111111110110100000000010101011100000001100101111111111111000101001110100101000000000001000001001000000111111111111011111111111111110010000010001010100101010010010001010100111010100101010010011111111100100010100101110010100101010111111110111100011110000000000101101"

int main(int argc, char **argv)
{
    char inputs[WIDTH * HEIGHT + 100];
	GStandardSpace * pStandardSpace = NULL;
	GParallelSpace * pSpace = NULL;
	GFastDeque * pDeque = NULL;
    GParallelSpace * pGoalSpace1 = NULL;
    GParallelSpace * pGoalSpace2 = NULL;

#ifdef _DEBUG
	strcpy(inputs, C2);
	//strcpy(inputs, "111110000000000000000000000011010010111111111110111111110100010010100000010000100000010010010011111100010000100111110010010010100101111100100000010010010110100101000100111111111110011010100101000100100000010010010010100101000100101111110010010010100101000100100000010010010110100101000100111111010110011010100101000100100000010010010010110111000111100000010010010010101001000100101111110110010010100101000101100000010010010010100001000110111111110110010010111101000100100000000010011110100000000101100000000110000000100000000110100000000010111000111111110100100000000010101000100000000100100000000010101000100000000101100000001110101000111111110110100000000010101000100000001100101111111110111000101001000100100000000000001000101001000000111111111111011111111111111110010000010001010100101010010010001010100111010100101010010011111111100100010100101110010100101010111111110111100011110000000000000001");
#else
    gets(inputs);
#endif

	pStandardSpace = GStandardSpace_Create(WIDTH, HEIGHT);

    pSpace = GParallelSpace_Create(pStandardSpace);
    GParallelSpace_InitializeTable(pSpace, inputs);
    GParallelSpace_InitializeEntry(pSpace, 29, 29);

    pDeque = GFastDeque_Create();
    GFastDeque_PushBack(pDeque, pSpace);

    // reuse pSpace in the while loop
    while (!pGoalSpace1 || !pGoalSpace2)
    {
        Direction dir;
        GParallelSpace * pParallel;

		if (GFastDeque_IsEmpty(pDeque))
        {
            break;
        }

        pSpace = (GParallelSpace*)GFastDeque_PopFront(pDeque);

		for ( dir = UP; dir <= LEFT; dir++ )
        {
            pParallel = GParallelSpace_Move(pSpace, dir);
            if (pParallel == NULL)
                continue;

            if ((pGoalSpace1 == NULL) && GParallelSpace_TestGoal(pParallel, 0, 0))
            {
                pGoalSpace1 = pParallel;
            }

            if ((pGoalSpace2 == NULL) && GParallelSpace_TestGoal(pParallel, 0, 29))
            {
                pGoalSpace2 = pParallel;
            }
            
			//printf("(%d,%d)->(%d,%d) ", pSpace->currentPos.x, pSpace->currentPos.y, pParallel->currentPos.x, pParallel->currentPos.y);
            GFastDeque_PushBack(pDeque, (void *)pParallel);
        }

		if (pSpace != pGoalSpace1 && pSpace != pGoalSpace2)
			GFastDeque_Destory(pSpace);
    }

    if (pGoalSpace1 != NULL)
		printf("%s", GParallelSpace_Output(pGoalSpace1));
	else
		printf("0");

    if (pGoalSpace2 != NULL)
		printf("%s", GParallelSpace_Output(pGoalSpace2));
	else
		printf("0");
}
